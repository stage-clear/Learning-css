# 擬似クラスと擬似要素

- 擬似クラスと擬似要素とは、ドキュメントツリーを拡張して得られた情報やドキュメントツリー
の外部にある情報を対象としたセレクタです
- 擬似クラスでは、要素の状態や種類に基づいて要素が選択されます
  - ホバー
  - アクセス済み
  - アクティブなど
- 擬似要素では、要素の一部だけを選択できます
  - テキストノードの特定の部分（先頭行や先頭文字）


## 4.1 構造をあらわす擬似クラス

- CSS2 では、構造を表す擬似クラスは `:first-child` だけでしたが、CSS3では11種追加されました

### 4.1.1 `:nth-*` 擬似クラス

引数として指定する n は 0から始まって1ずつ加算されていく整数を表します

```css
E:nth-*(n) { }
```

`n` の値を整数倍することもできます(`2n`, `3n`)

```css
E:nth-*(2n) { }     /* 2の倍数 */
E:nth-*(3n) { }     /* 3の倍数 */
```

`+` と `-` を使った加減算も可能です (`2n+1`, `3n-1`)

```css
E:nnh-*(n+1) { }    /* n の次の要素 */
E:nth-*(2n+1) { }   /* 2の倍数の次の要素 */
E:nth-*(3n-1) { }   /* 3の倍数の前の要素 */
```

`event` （偶数）と `odd` （奇数）というキーワードも用意されています

```css
E:nth-*(even) { }   /* 偶数番目の要素 */
E:nth-*(odd) { }    /* 奇数番目の要素 */
```

0倍数（`0n`）も指定可能です。単体では使い道がありませんが、加算と組み合わせると意味を持
つようになり、特定の1つの要素だけを繰り返さずに選択できます。ただ、`0n+`を省略して番号だけ
を指定することもできます。

```css
E:nth-*(0n+3) { }   /* 3番目の要素を選択 */
E:nth-*(3) { }      /* 3番目の要素を選択 */
```

#### 4.1.1.1 `:nth-child()` と `nth-of-type()`

- `:nth-child` : 子要素全体の中での位置
- `:nth-of-type` : 特定の子要素の中での位置


#### 4.1.1.2 `:nth-last-child()` と `:nth-last-of-type()`

- `:nth-last-child` : 子要素全体の中での最後からの位置
- `:nth-last-of-type` : 特定の子要素の中での最後からの位置

__例) 最後から x個の要素を選択する__

```css
E:nth-last-child(-n+2) { }
```


### 4.1.2 `:first-of-type` `:last-child` `:last-of-type`

- `:first-of-type` : 特定の子要素の中の最初の要素
- `:last-child` : 子要素全体の中の最後の要素
- `:last-of-type` : 特定の子要素の中の最後の要素


### 4.1.3 `:only-child` と `only-of-type`

- `:only-child` : 兄弟要素がまったくない要素
- `:only-of-type` : 同じ型の兄弟要素がない要素


## 4.2 その他の擬似クラス

### 4.2.1 `:target`

- ページ内リンクでのリンク先ターゲットを選択
- リンクがクリックされたときに適用されます

__例1__

```html
<h4 id="my_id">Lorem ipsum</h4>
<a href="#my_id">Lorem</a>
```

```css
#my_id:target {
  font-weight: bold;
  background: #ddd;
}
```

__例2__

```html
<div class="comment" id="comment-01">
  <p>... ... ... </p>
  <p class="author">... ... ...</p>
</div>
```

```css
.comment:target {
  background: #ddd;
}
```


### 4.2.2 `:empty`

- 子要素もテキストノードも含まない空の要素を選択

```html
<tr>
  <td></td>
  <td><span></span></td>
</tr>
```

```css
td:empty { background-color: red; }
```


### 4.2.3 `:root`

- ドキュメントツリーの最初に現れる要素
- HTMLでこの擬似要素を使うメリットは、詳細度を高め指定を上書きしたいとき

```css
html { }      /* 詳細度: 1 */
html:root { } /* 詳細度: 2 */
```


### 4.2.4 `:not()`

- 引数として指定された要素以外の全ての要素を選択
- 渡す引数はシンプルなセレクタでなくても構わず、擬似要素なども指定できます

```css
E:not(F) { }
```

```css
div > :not(p) { } /* p 以外の子要素 */
p:not(:first-child) { } /* p の要素のうち先頭以外の要素 */
```

### 4.2.5 UI要素の状態

- フォームやユーザーの入力が関係する要素は、複数の内部状態を持つことがあります

```css
:checked { }
:disabled { }
:enabled { } /* HTMLに enabled という属性はなく disabled ではない要素がこれにあたる */
```

### 4.2.6 制約に基づく検証の擬似クラス

```css
:required { }   /* 必須 */
:optional { }   /* 任意 */
:valid { }      /* 検証結果が正当 */
:invalid { }    /* 検証結果が不当 */
:in-range { }   /* min属性 max属性の範囲内 */
:out-range { }  /* min属性 max属性の範囲外*/
```


## 4.3 擬似要素

- 擬似クラスと同様に、擬似要素もドキュメントツリーには含まれていない情報を提供します
- CSS3の擬似要素での接頭辞はコロン2つ（`::`）となりました


```css
::first-line { }
::first-letter { }
::after { }
::before { }
```

### 4.3.1 `::selection` 擬似要素

- ユーザがブラウザで選択した部分に対して適用できます


## 4.4 まとめ
